<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/basicLayout}">

<th:block layout:fragment="script">
  <script th:inline="javascript">

    var regName = /^[가-힣a-zA-Z0-9_]+$/;			// 이름은 한글/영문/숫자 가능
    var regAddress = /^[가-힣a-zA-Z0-9_ ]+$/;			// 주소는 한글/영문/숫자/공백 가능

    function emailCheck() {
      alert("이메일주소는 수정하실수 없습니다.");
    }

    // 성명체크
    function nameCheck() {
      let name = document.getElementById("name").value;
      let str = '';
      if (name === '') {
        $("#nameResult").css("color", "blue").html('이름을 입력해주세요.');
        return;
      }
      if(!regName.test(name)) {
        str = '이름은 "한글/영문/숫자/_"만 사용가능합니다.';
        $("#nameResult").css("color", "red").html(str);
        return;
      }
      else if(name.length < 2 || name.length > 20) {
        str = '이름은 2자 이상 20자 이하만 가능합니다.';
        $("#nameResult").css("color", "red").html(str);
        return;
      }
      else {
        $("#nameResult").css("color", "green").html("✅ 사용 가능합니다.");
      }
    }

    // 주소체크
    function addressCheck() {
      let address = document.getElementById("address").value;
      let str = '';
      if (address === '') {
        $("#addressResult").css("color", "blue").html('주소를 입력해주세요.');
        return;
      }
      if(!regAddress.test(address)) {
        str = '주소는 "한글/영문/숫자/_"만 사용가능합니다.';
        $("#addressResult").css("color", "red").html(str);
        return;
      }
      else if(address.length < 2 || address.length > 50) {
        str = '주소는 2자 이상 50자 이하만 가능합니다.';
        $("#addressResult").css("color", "red").html(str);
        return;
      }
      else {
        $("#addressResult").css("color", "green").html("✅ 사용 가능합니다.");
      }
    }
  </script>
</th:block>

<th:block>
  <style>
    .fieldError {
      color: #f00 !important;
      font-size: 12px !important;
    }
    p {text-align: left}
  </style>
</th:block>


<div layout:fragment="content">

  <h2 class="text-center">회 원 정 보 수 정</h2>
  <form role="form" method="post" th:object="${dto}">
    <div class="input-group mb-3">
      <label th:for="email" class="input-group-text bg-secondary-subtle">이메일주소</label>
      <input type="email" th:field="*{email}" onclick="emailCheck()" class="form-control" placeholder="이메일을 입력해주세요" readonly>
      <!--<div class="input-group-text">[[${dto.email}]]</div>-->
    </div>
    <div class="input-group mb-1">
      <label th:for="name" class="input-group-text bg-secondary-subtle">이름</label>
      <input type="text" th:field="*{name}" onkeyup="nameCheck()" class="form-control" placeholder="이름을 입력해주세요" />
    </div>
    <div id="nameResult" class="text-start ms-5 mb-3"></div>
    <div th:if="${#fields.hasErrors('name')}" th:errors="*{name}" class="fieldError mb-3" style="color:red; font-size:13px; text-align:left">Incorrect data</div>
    <div class="input-group mb-1">
      <label th:for="address" class="input-group-text bg-secondary-subtle">주소</label>
      <input type="text" th:field="*{address}" id="address" onkeyup="addressCheck()" class="form-control" placeholder="주소를 입력해주세요">
    </div>
    <div id="addressResult" class="text-start ms-5 mb-3"></div>
    <div th:if="${#fields.hasErrors('address')}" th:errors="*{address}" class="fieldError" style="color:red; font-size:13px; text-align:left">Incorrect data</div>
    <div style="text-align: center">
      <button type="submit" class="btn btn-primary me-2">정보수정</button>
      <button type="button" onclick="location.href='/member/memberMain'" class="btn btn-warning">돌아가기</button>
    </div>
    <input type="hidden" name="password" value="0000"/>
    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
  </form>

</div>

</html>